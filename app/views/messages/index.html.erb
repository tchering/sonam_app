<style>
    .message-container {
        max-height: 400px;
        overflow-y: auto;
    }
</style>

<% if @over_ten %>
   <%= link_to "Show Previous", "?m=all", class: "btn btn-primary mb-3" %>
<% end %>

<div class="card message-container">
  <% @messages.each do |message| %>
    <% if message.body %>
      <% user = User.find(message.user_id) %>
      <div class="card-body">
        <% if user == current_user %>
          <div class="d-flex justify-content-end text-dark">
            <div>
                <h6 class="card-subtitle mb-2"><strong><%= user.name %></strong>  <small class="text-muted"><%= message.message_time %></small></h6>
              <p class="card-text text-primary">
                <%= fa_icon "caret-right" %>
                <%= message.body %>
                <%= link_to conversation_message_path(@conversation, message), method: :delete, data: { confirm: "Are you sure?", turbo_method: :delete, turbo_action: "replace" } do %>
   <%= fa_icon "trash" %>
<% end %>
              </p>
              <% if message.user == current_user %>

<% end %>
              
            </div>
          </div>
        <% else %>
          <div class="d-flex justify-content-start text-dark">
            <div>
                 <h6 class="card-subtitle mb-2"><strong><%= user.name %></strong> <small class="text-muted"><%= message.message_time %></small></h6>
              <p class="card-text text-primary">
                <%= fa_icon "caret-right" %>
                <%= message.body %>
              </p>
             
            </div>
          </div>
        <% end %>
      </div>
      <hr class="m-0">
    <% end %>
  <% end %>
</div>

<%= form_for [@conversation, @message], html: { class: "mt-3" } do |f| %>
  <div class="form-group">
    <%= f.label :Message %>
    <%= f.text_area :body, class: "form-control" %>
  </div>
  <%= f.text_field :user_id, value: current_user.id, type: "hidden" %>
  <div>
    <%= f.submit "Add Reply", class: "btn btn-primary" %>
  </div>
<% end %>

<script>
window.onload = function() {
  var messageContainer = document.querySelector('.message-container');
  messageContainer.scrollTop = messageContainer.scrollHeight;
}
</script>